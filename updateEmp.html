<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
  </head>
  <body>
    <main class="d-flex">
      <section class="side-nav" id="side-nav-bar">
        <div>
          <div class="d-flex jc-space-btwn">
            <div class="logo-tezo" id="nav-hide-logo">
              <img src="./assets/TezoLogo.svg" alt="tezo logo-tezo" />
            </div>
            <div class="close-button">
              <img
                id="close-btn"
                src="./assets/handle.png"
                alt=""
                onclick="hideNavBar()"
              />
            </div>
          </div>

          <div class="all mt-20">
            <span class="nav-text-vh">ALL</span>
            <div class="mt-20">
              <div class="side-nav-items">
                <div>
                  <img
                    class="d-flex"
                    src="./assets/Horizontal nav/Dashboard.svg"
                    alt=""
                  />
                </div>
                <div class="nav-item-name">
                  <span class="nav-text">Dashboard</span>
                </div>
              </div>
              <a href="./index.html" class="td-none">
                <div class="side-nav-items bg-light-red-theme side-red">
                  <div>
                    <img
                      class="d-flex"
                      src="./assets/Horizontal nav/Employees.svg"
                      alt=""
                    />
                  </div>
                  <div class="nav-item-name">
                    <span class="nav-text">Employees</span>
                  </div>
                </div>
              </a>
            </div>
          </div>

          <div class="role-user mt-20">
            <span class="nav-text-vh">ROLE / USER MANAGEMENT</span>
            <div class="mt-20">
              <a href="./roles.html" class="td-none">
                <div class="side-nav-items">
                  <div>
                    <img
                      class="d-flex"
                      src="./assets/Horizontal nav/Roles.svg"
                      alt=""
                    />
                  </div>
                  <div class="nav-item-name">
                    <span class="nav-text">Roles</span>
                  </div>
                  <div class="arrow-right" id="arrow-right">
                    <i
                      class="ph-bold ph-caret-right"
                      onclick="showDropDownEmployees()"
                    ></i>
                  </div>
                </div>
              </a>
              <div class="side-nav-items">
                <div>
                  <img
                    class="d-flex"
                    src="./assets/Horizontal nav/assign user.svg"
                    alt=""
                  />
                </div>
                <div class="nav-item-name">
                  <span class="nav-text">Access rights</span>
                </div>
                <div class="arrow-right">
                  <i class="ph-bold ph-caret-right"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="install-update" id="hide-install-box">
          <p class="new-update">Install new update 2.3.1A</p>
          <p class="allow-launch">
            Allow to launch the new update for the AD application
          </p>
          <div class="accept-reject-btns d-flex">
            <button class="btn-dismiss">Dismiss</button>
            <button class="btn-accept">Accept</button>
          </div>
        </div>
      </section>
      <section class="vertical-page">
        <div class="vertical-nav">
          <div class="top-search-bar">
            <div class="search-box">
              <input
                type="search"
                placeholder="Search"
                onkeypress="handleSearchBox()"
                id="search-input"
              />
            </div>
            <div class="icons d-flex">
              <div class="search-icons">
                <img src="./assets/IconButton.png" alt="" />
                <img src="./assets/icon1.png" alt="" />
                <img src="./assets/icon2.png" alt="" />
                <img src="./assets/icon3.png" alt="" />
                <img
                  class="img-user-navbar"
                  src="./assets/user-table.jpg"
                  alt=""
                />
              </div>
              <div class="user-profile">
                <span class="john">John Abraham</span>
                <br />
                <span class="admin">Admin</span>
              </div>
              <div class="search-drop-down">
                <i class="ph-bold ph-caret-down"></i>
              </div>
            </div>
          </div>
        </div>
        <div class="emp-inp-form">
          <form name="form-data">
            <h4>Update Employee</h4>
            <div class="d-flex g-3" id="inp-form">
              <div class="inp-form-profile">
                <img src="./assets/user-image.png" alt="" id="user-img" />
                <label for="upload-img" class="d-flex" id="edit">Edit</label>
                <button class="padding-lr btn-accept btn-emp" id="btn-upload">
                  <label for="upload-img" class="p-0"
                    >Upload Profile Picture</label
                  >
                </button>
                <input type="file" name="upload-image" id="upload-img" />
              </div>
              <div class="inp-form-info">
                <h5>Personal Information</h5>
                <div class="inp-form-row-1">
                  <label for="" class="d-block"
                    >Emp No
                    <i class="ph-bold ph-asterisk c-p star-validation"
                      ><span class="tool-tip-text">Required</span></i
                    ></label
                  >
                  <input
                    class="d-block"
                    type="text"
                    name="emp-no"
                    id="emp-no"
                    placeholder="EX: TZ123"
                  />
                  <p class="m-0 validation-msg d-none" id="validate-msg-empno">
                    <span><i class="ph-fill ph-warning-diamond"></i></span> This
                    field is required
                  </p>
                </div>

                <div class="inp-form-rows inp-form-row-1">
                  <div class="col-1">
                    <label for=""
                      >First Name
                      <i class="ph-bold ph-asterisk c-p star-validation"
                        ><span class="tool-tip-text">Required</span></i
                      ></label
                    ><br />
                    <input
                      type="text"
                      name="fname"
                      id="fname"
                      placeholder="Text"
                    />
                    <p
                      class="m-0 validation-msg d-none"
                      id="validate-msg-fname"
                    >
                      <span><i class="ph-fill ph-warning-diamond"></i></span>
                      This field is required
                    </p>
                  </div>
                  <div class="col-2">
                    <label for=""
                      >Last Name
                      <i class="ph-bold ph-asterisk c-p star-validation"
                        ><span class="tool-tip-text">Required</span></i
                      ></label
                    ><br />
                    <input
                      type="text"
                      name="lname"
                      id="lname"
                      placeholder="Text"
                    />
                    <p
                      class="m-0 validation-msg d-none"
                      id="validate-msg-lname"
                    >
                      <span><i class="ph-fill ph-warning-diamond"></i></span>
                      This field is required
                    </p>
                  </div>
                  <div class="col-3">
                    <label for="">Date of Birth</label><br />
                    <input type="date" name="dob" id="dob" />
                  </div>
                </div>
                <div class="inp-form-rows inp-form-row-1">
                  <div class="col-1">
                    <label for=""
                      >Email Id
                      <i class="ph-bold ph-asterisk c-p star-validation"
                        ><span class="tool-tip-text">Required</span></i
                      ></label
                    ><br />
                    <input
                      type="email"
                      name="email"
                      id="email"
                      placeholder="Joe.j@technovert.com"
                    />
                    <p
                      class="m-0 validation-msg d-none"
                      id="validate-msg-email"
                    >
                      <span><i class="ph-fill ph-warning-diamond"></i></span>
                      This field is required
                    </p>
                  </div>
                  <div class="col-2">
                    <label for="">Mobile Number</label><br />
                    <input
                      type="number"
                      name="number"
                      id="mobile"
                      placeholder="0000000000"
                    />
                    <p
                      class="m-0 validation-msg d-none"
                      id="validate-msg-mobile"
                    >
                      <span><i class="ph-fill ph-warning-diamond"></i></span>
                      This field is required
                    </p>
                  </div>
                </div>
                <h5>Employement Information</h5>
                <div class="inp-form-rows inp-form-row-2">
                  <div class="col-1">
                    <label for=""
                      >Joining Date
                      <i class="ph-bold ph-asterisk c-p star-validation"
                        ><span class="tool-tip-text">Required</span></i
                      ></label
                    ><br />
                    <input
                      placeholder="mm/dd/yyyy"
                      type="date"
                      name="jdate"
                      id="jdate"
                    />
                    <p
                      class="m-0 validation-msg d-none"
                      id="validate-msg-jdate"
                    >
                      <span><i class="ph-fill ph-warning-diamond"></i></span>
                      This field is required
                    </p>
                  </div>
                  <div class="col-2">
                    <label for="">Location</label><br />
                    <select name="location" id="location">
                      <option value="" id="">Hyderabad</option>
                      <option value="">Delhi</option>
                      <option value="">Mumbai</option>
                      <option value="">Chennai</option>
                    </select>
                  </div>
                </div>
                <div class="inp-form-rows inp-form-row-2">
                  <div class="col-1">
                    <label for="">Job Title</label><br />
                    <select name="job-title" id="job-title">
                      <option value="">UX Designer</option>
                      <option value="">SDE1</option>
                      <option value="">SDE2</option>
                      <option value="">SDE3</option>
                    </select>
                  </div>
                  <div class="col-2">
                    <label for="">Department</label><br />
                    <select name="dept" id="dept-inp-form">
                      <option value="">UI/UX</option>
                      <option value="">BI</option>
                      <option value="">PE</option>
                      <option value="">Testing</option>
                    </select>
                  </div>
                </div>
                <div class="inp-form-rows inp-form-row-2">
                  <div class="col-1">
                    <label for="">Assign Manager</label><br />
                    <select name="assign" id="assign-job">
                      <option value="">Search</option>
                    </select>
                  </div>
                  <div class="col-2">
                    <label for="">Assign Project</label><br />
                    <select name="assign-proj" id="assign-inp-proj">
                      <option value="">Search</option>
                    </select>
                  </div>
                </div>
                <div class="inp-form-btns mt-20">
                  <a href="./index.html" class="td-none"
                    ><button class="btn-dismiss padding-lr">Cancel</button></a
                  >
                  <button
                    class="btn-accept padding-lr"
                    onclick="handleUpdateEmp()"
                    type="button"
                  >
                    Update Employee
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </section>
      <div class="toaster d-none" id="show-toast">
        Record Updated Successfully
      </div>
    </main>
    <script src="script.js"></script>
    <script>
      //accessing from the local storage and filling in the forms
      let updateData = localStorage.getItem("updateEmp");
      if (updateData != undefined) {
        updateData = JSON.parse(updateData);
        document.forms["form-data"]["emp-no"].value = updateData.EMPNO.slice(
          0,
          8
        );
        document.forms["form-data"]["fname"].value =
          updateData.USER.split(" ")[0];
        document.forms["form-data"]["lname"].value =
          updateData.USER.split(" ")[1];
        document.forms["form-data"]["email"].value =
          updateData.USER.split(" ")[0] + "@tezo.com";
        document.forms["form-data"]["jdate"].value = updateData.JOINDT;
        let l = document.getElementById("location");
        l.options[l.selectedIndex].text = updateData.LOCATION;
      }

      //For Upload the profile picture
      let inpFile = document.getElementById("upload-img");
      let profilePic = document.getElementById("user-img");
      let uploadbtn = document.getElementById("btn-upload");
      inpFile.onchange = () => {
        let imgName = inpFile.files[0].name;

        localStorage.setItem("img", imgName);
        profilePic.src = URL.createObjectURL(inpFile.files[0]);
      };
      uploadbtn.onclick = () => {
        profilePic.src = URL.createObjectURL(inpFile.files[0]);
      };

      //for checking the fields are filled
      let emptyfield = false;
      function checkAllFields() {
        let fields = ["emp-no", "fname", "lname", "email", "jdate"];
        for (let i = 0; i < fields.length; i++) {
          if (document.forms["form-data"][fields[i]].value === "") {
            emptyfield = true;
          }
        }
        if (emptyfield) {
          return false;
        } else {
          return true;
        }
      }

      //Reseting the form brfore adding
      function resetForm() {
        let fields = ["emp-no", "fname", "lname", "email", "jdate"];
        for (let i = 0; i < fields.length; i++) {
          document.forms["form-data"][fields[i]].value = "";
        }
      }

      handleUpdateEmp = () => {
        if (checkAllFields()) {
          let e = document.getElementById("dept-inp-form");
          let DEPARTMENT = e.options[e.selectedIndex].text;

          let l = document.getElementById("location");
          let LOCATION = l.options[l.selectedIndex].text;

          let j = document.getElementById("job-title");
          let ROLE = j.options[j.selectedIndex].text;

          let a = document.getElementById("assign-job");
          let Assign_Job = a.options[a.selectedIndex].text;

          let i = document.getElementById("assign-inp-proj");
          let Assign_Project = i.options[i.selectedIndex].text;

          let USER =
            document.getElementById("fname").value +
            " " +
            document.getElementById("lname").value;
          let EMPNO = document.getElementById("emp-no").value;
          let dob = document.getElementById("dob").value;
          let email = document.getElementById("email").value;
          let mobile = document.getElementById("mobile").value;
          let JOINDT = document.getElementById("jdate").value;
          let img = document.getElementById("user-img").src;
          let uniqID = EMPNO;
          let oldData=(JSON.parse(localStorage.getItem("addData")));
          let updateID;
          for(k in oldData){
            if(uniqID==oldData[k].EMPNO){
                oldData[k].USER=USER;
                oldData[k].dob=dob;
                oldData[k].LOCATION=LOCATION;
                oldData[k].JOINDT=JOINDT;
                oldData[k].DEPARTMENT=DEPARTMENT;
                oldData[k].ROLE=ROLE
            }
          }
          oldData=JSON.stringify(oldData);
        localStorage.setItem("addData", oldData);
          window.scrollTo(top);
          document.getElementById("show-toast").classList.toggle("d-none");
          resetForm();
          setTimeout(() => {
            window.location.href = "./index.html";
          }, 3000);
        } 
        else {
          let a = document.getElementsByClassName("validation-msg");

          if (document.getElementById("fname").value === "") {
            document
              .getElementById("validate-msg-fname")
              .classList.remove("d-none");
          }
          if (document.getElementById("lname").value === "") {
            document
              .getElementById("validate-msg-lname")
              .classList.remove("d-none");
          }
          if (document.getElementById("emp-no").value === "") {
            document
              .getElementById("validate-msg-empno")
              .classList.remove("d-none");
          }

          if (document.getElementById("email").value === "") {
            document
              .getElementById("validate-msg-email")
              .classList.remove("d-none");
          }
          if (document.getElementById("mobile").value === "") {
            document
              .getElementById("validate-msg-mobile")
              .classList.remove("d-none");
          }
          if (document.getElementById("jdate").value === "") {
            document
              .getElementById("validate-msg-jdate")
              .classList.remove("d-none");
          }

          document.getElementById("edit").className -= "d-flex";
          document.getElementById("edit").className += " show";
          document.getElementById("btn-upload").className -= " btn-emp";
          document.getElementById("btn-upload").className +=
            " btn-accept  h-3  ";
          document.getElementById("inp-form").className -= "d-flex";
          let y = document.getElementsByClassName("inp-form-profile");
          y[0].className += " d-flex  g-05 align-items-center ";
          let x = document.getElementsByClassName("inp-form-row-1");
          for (let i = 0; i < x.length; i++) {
            x[i].className += " inp-validation";
          }
        }
      };
    </script>
  </body>
</html>
